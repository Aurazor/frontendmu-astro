---
import LayoutSingleMeetup from "../../layouts/LayoutSingleMeetup.astro";
import MeetupSingle from "../../components/MeetupSingle.astro";
import { getDirectusClient } from "../../utils/directus-client";

const props = Astro.params;

export async function getStaticPaths() {
    const directus = await getDirectusClient();
    const response = await directus.items("Events").readByQuery({
    	fields: ["*.*"],
    });    

    return response.data.map((event) => {
    	return { 
            params: {
                id: event.id.toString(),
                		
            },    	
        };
    });
}

// Get Data for the current meetup based on the id
const directus = await getDirectusClient();
const getCurrentMeetup = await directus.items("Events").readByQuery({
    filter: {
        id: {
            _eq: props.id,
        },
    },
	fields: ["*.*"],
});

const meetup = getCurrentMeetup.data[0];

---

<LayoutSingleMeetup title={meetup.title} description={meetup.description}>

    <MeetupSingle
        routeId={props.id}
        getCurrentEvent={meetup}
    />

</LayoutSingleMeetup>
